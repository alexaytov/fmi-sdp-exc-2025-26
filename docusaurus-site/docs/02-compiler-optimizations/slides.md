---
title: –ö–æ–º–ø–∏–ª–∞—Ç–æ—Ä–Ω–∏ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏, –õ–æ–∫–∞–ª–Ω–æ—Å—Ç, –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏ –∏ –ú–∞—Å–∏–≤–∏ –≤ C++
theme: white
highlightTheme: github
transition: slide
controls: true
progress: true
slideNumber: true
---

# ‚ö° –ö–æ–º–ø–∏–ª–∞—Ç–æ—Ä–Ω–∏ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

## –õ–æ–∫–∞–ª–Ω–æ—Å—Ç, –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏ –∏ –ú–∞—Å–∏–≤–∏ –≤ C++

**–õ–µ–∫—Ü–∏—è 2** ‚Ä¢ –°—Ç—Ä—É–∫—Ç—É—Ä–∏ –æ—Ç –î–∞–Ω–Ω–∏ –∏ –ü—Ä–æ–≥—Ä–∞–º–∏—Ä–∞–Ω–µ

---

## üìã –°—ä–¥—ä—Ä–∂–∞–Ω–∏–µ

üéØ **–í—ä–≤–µ–¥–µ–Ω–∏–µ –∏ –ú–æ—Ç–∏–≤–∞—Ü–∏—è**

‚ö° **–ö–æ–º–ø–∏–ª–∞—Ç–æ—Ä–Ω–∏ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏**

üì¶ **–õ–æ–∫–∞–ª–Ω–æ—Å—Ç –Ω–∞ –î–∞–Ω–Ω–∏—Ç–µ**

üîß **C++ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏ –∏ –ú–∞—Å–∏–≤–∏**

üí° **–ü—Ä–∞–∫—Ç–∏–∫–∞ —Å Compiler Explorer**

Note:
–î–Ω–µ—Å —â–µ —Ä–∞–∑–≥–ª–µ–¥–∞–º–µ –∫–∞–∫ –∫–æ–º–ø–∏–ª–∞—Ç–æ—Ä–∏—Ç–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–∞—Ç –Ω–∞—à–∏—è –∫–æ–¥, –∑–∞—â–æ –ª–æ–∫–∞–ª–Ω–æ—Å—Ç—Ç–∞ –Ω–∞ –¥–∞–Ω–Ω–∏—Ç–µ –µ –∫—Ä–∏—Ç–∏—á–Ω–∞ –∑–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–Ω–æ—Å—Ç—Ç–∞, –∏ –∫–∞–∫ –¥–∞ –∏–∑–±–∏—Ä–∞–º–µ –ø—Ä–∞–≤–∏–ª–Ω–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏ –≤ C++.

---

<!-- .slide: data-background="#e7f3ff" -->

# üéØ –ß–∞—Å—Ç 1

## –í—ä–≤–µ–¥–µ–Ω–∏–µ –∏ –ú–æ—Ç–∏–≤–∞—Ü–∏—è

---

## ü§î –ó–∞—â–æ –¥–∞ –∏–∑—É—á–∞–≤–∞–º–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏?

### ‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–Ω–æ—Å—Ç
- –ö–æ–º–ø–∏–ª–∞—Ç–æ—Ä—ä—Ç –Ω–µ –µ –º–∞–≥–∏—è
- –ü—Ä–æ–≥—Ä–∞–º–∏—Å—Ç—ä—Ç –º–æ–∂–µ –¥–∞ –ø–æ–º–æ–≥–Ω–µ –∏–ª–∏ –ø—Ä–µ—á–∏
- –†–∞–∑–±–∏—Ä–∞–Ω–µ—Ç–æ –≤–æ–¥–∏ –¥–æ –ø–æ-–¥–æ–±—Ä–∏ —Ä–µ—à–µ–Ω–∏—è

### üß† –†–∞–∑–±–∏—Ä–∞–Ω–µ –Ω–∞ —Ö–∞—Ä–¥—É–µ—Ä–∞
- –ú–æ–¥–µ—Ä–Ω–∏—Ç–µ CPU —Å–∞ —Å–ª–æ–∂–Ω–∏
- Cache –π–µ—Ä–∞—Ä—Ö–∏—è—Ç–∞ –µ –∫—Ä–∏—Ç–∏—á–Ω–∞
- –ü–∞–º–µ—Ç–Ω–∞—Ç–∞ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –∏–º–∞ –æ–≥—Ä–æ–º–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ

### üìä –†–µ–∞–ª–Ω–∏ —Ä–µ–∑—É–ª—Ç–∞—Ç–∏
- Cache miss = 100-300x –ø–æ-–±–∞–≤–Ω–æ
- –î–æ–±—Ä–∞—Ç–∞ –ª–æ–∫–∞–ª–Ω–æ—Å—Ç = 10-100x —É—Å–∫–æ—Ä–µ–Ω–∏–µ
- –í–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è—Ç–∞ = 2-4x —É—Å–∫–æ—Ä–µ–Ω–∏–µ

Note:
–†–∞–∑–±–∏—Ä–∞–Ω–µ—Ç–æ –Ω–∞ –∫–æ–º–ø–∏–ª–∞—Ç–æ—Ä–Ω–∏—Ç–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –≤–∏ –ø—Ä–∞–≤–∏ –ø–æ-–¥–æ–±—ä—Ä –ø—Ä–æ–≥—Ä–∞–º–∏—Å—Ç. –ù–µ —Å—Ç–∞–≤–∞ –≤—ä–ø—Ä–æ—Å –∑–∞ –º–∏–∫—Ä–æ-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏, –∞ –∑–∞ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª–Ω–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∏ —Ä–µ—à–µ–Ω–∏—è.

---

<!-- .slide: data-background="#e8f5e9" -->

# –ß–∞—Å—Ç 2

## –ö–æ–º–ø–∏–ª–∞—Ç–æ—Ä–Ω–∏ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

---

## –ö–∞–∫–≤–æ —Å–∞ –ö–æ–º–ø–∏–ª–∞—Ç–æ—Ä–Ω–∏ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏?

> –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏ –ø–æ –≤—Ä–µ–º–µ –Ω–∞ –∫–æ–º–ø–∏–ª–∞—Ü–∏—è –∑–∞ –ø–æ–¥–æ–±—Ä—è–≤–∞–Ω–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–Ω–æ—Å—Ç—Ç–∞ **–±–µ–∑ –ø—Ä–æ–º—è–Ω–∞ –Ω–∞ –Ω–∞–±–ª—é–¥–∞–≤–∞–Ω–æ—Ç–æ –ø–æ–≤–µ–¥–µ–Ω–∏–µ**

**–ö–æ–º–ø–∏–ª–∞—Ç–æ—Ä—ä—Ç:**
- –ê–Ω–∞–ª–∏–∑–∏—Ä–∞ –∫–æ–¥–∞
- –ü—Ä–∏–ª–∞–≥–∞ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏
- –ì–µ–Ω–µ—Ä–∏—Ä–∞ –ø–æ-–µ—Ñ–µ–∫—Ç–∏–≤–µ–Ω assembly

Note:
–ö–æ–º–ø–∏–ª–∞—Ç–æ—Ä–∏—Ç–µ —Å–∞ –∏–∑–∫–ª—é—á–∏—Ç–µ–ª–Ω–æ —É–º–Ω–∏, –Ω–æ –∏–º–∞—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è. –¢—Ä—è–±–≤–∞ –¥–∞ –∑–∞–ø–∞–∑—è—Ç —Å–µ–º–∞–Ω—Ç–∏–∫–∞—Ç–∞ –Ω–∞ –ø—Ä–æ–≥—Ä–∞–º–∞—Ç–∞.

---

## –û—Å–Ω–æ–≤–Ω–∏ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### Constant Folding

–ò–∑—á–∏—Å–ª—è–≤–∞ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∏ –ø—Ä–∏ –∫–æ–º–ø–∏–ª–∞—Ü–∏—è

```cpp
int x = 5 + 3;  // –ö–æ–º–ø–∏–ª–∞—Ç–æ—Ä—ä—Ç –≥–µ–Ω–µ—Ä–∏—Ä–∞: int x = 8;
int y = 2 * 4;  // int y = 8;
```

--

### Constant Propagation

–ó–∞–º–µ—Å—Ç–≤–∞ –ø—Ä–æ–º–µ–Ω–ª–∏–≤–∏ –∏–∑–≤–µ—Å—Ç–Ω–∏ –∫–∞—Ç–æ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∏

```cpp
const int N = 10;
int arr[N];  // –ö–æ–º–ø–∏–ª–∞—Ç–æ—Ä—ä—Ç –∏–∑–ø–æ–ª–∑–≤–∞ 10 –¥–∏—Ä–µ–∫—Ç–Ω–æ
```

--

### Dead Code Elimination

–ü—Ä–µ–º–∞—Ö–≤–∞ –Ω–µ–∏–∑–ø–æ–ª–∑–≤–∞–Ω –∫–æ–¥

```cpp
int unused = 42;  // –ù–∏–∫–æ–≥–∞ –Ω–µ —Å–µ —á–µ—Ç–µ
// ... –∫–æ–¥ ...
return x;
unused = 10;      // –ù–µ–¥–æ—Å—Ç–∏–∂–∏–º –∫–æ–¥
// –ö–æ–º–ø–∏–ª–∞—Ç–æ—Ä—ä—Ç –ø—Ä–µ–º–∞—Ö–≤–∞ –∏ –¥–≤–µ—Ç–µ –ª–∏–Ω–∏–∏!
```

--

### Common Subexpression Elimination (CSE)

–ò–∑—á–∏—Å–ª—è–≤–∞ –∏–¥–µ–Ω—Ç–∏—á–Ω–∏ –∏–∑—Ä–∞–∑–∏ –≤–µ–¥–Ω—ä–∂

```cpp
int a = x * y + z;
int b = x * y + w;
// –ö–æ–º–ø–∏–ª–∞—Ç–æ—Ä—ä—Ç –∏–∑—á–∏—Å–ª—è–≤–∞ x * y –≤–µ–¥–Ω—ä–∂:
// temp = x * y;
// a = temp + z;
// b = temp + w;
```

Note:
–¢–æ–≤–∞ —Å–∞ –æ—Å–Ω–æ–≤–Ω–∏—Ç–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏. –ö–æ–º–ø–∏–ª–∞—Ç–æ—Ä—ä—Ç –ø—Ä–∞–≤–∏ –º–Ω–æ–≥–æ –ø–æ–≤–µ—á–µ!

---

## Loop –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### Loop Unrolling

<div class="columns">
<div class="column left">

**–û—Ä–∏–≥–∏–Ω–∞–ª–µ–Ω —Ü–∏–∫—ä–ª:**
```cpp
for (int i = 0; i < 4; ++i) {
    sum += arr[i];
}
```

**–°–ª–µ–¥ unrolling:**
```cpp
sum += arr[0];
sum += arr[1];
sum += arr[2];
sum += arr[3];
```

</div>
<div class="column right">

**–ü—Ä–µ–¥–∏–º—Å—Ç–≤–∞:**
- ‚úÖ –ù–∞–º–∞–ª—è–≤–∞ loop overhead
- ‚úÖ –ü–æ–¥–æ–±—Ä—è–≤–∞ instruction pipelining
- ‚úÖ –ü–æ–∑–≤–æ–ª—è–≤–∞ SIMD

**–ù–µ–¥–æ—Å—Ç–∞—Ç—ä—Ü–∏:**
- ‚ùå –£–≤–µ–ª–∏—á–∞–≤–∞ —Ä–∞–∑–º–µ—Ä–∞ –Ω–∞ –∫–æ–¥–∞
- ‚ùå –ú–æ–∂–µ –¥–∞ –≤–ª–æ—à–∏ instruction cache

</div>
</div>

Note:
Loop unrolling –µ –º–æ—â–Ω–∞ —Ç–µ—Ö–Ω–∏–∫–∞, –Ω–æ —Ç—Ä—è–±–≤–∞ –¥–∞ —Å–µ –±–∞–ª–∞–Ω—Å–∏—Ä–∞ —Å—Ä–µ—â—É instruction cache overhead.

---

## Loop Invariant Code Motion

–ü—Ä–µ–º–µ—Å—Ç–≤–∞ –∏–∑—á–∏—Å–ª–µ–Ω–∏—è –∏–∑–≤—ä–Ω —Ü–∏–∫—ä–ª–∞ –∞–∫–æ —Ä–µ–∑—É–ª—Ç–∞—Ç—ä—Ç –Ω–µ —Å–µ –ø—Ä–æ–º–µ–Ω—è

<div class="columns">
<div class="column left">

**‚ùå –ü—Ä–µ–¥–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:**
```cpp
for (int i = 0; i < n; ++i) {
    arr[i] = arr[i] * (x + y + z);
}
```

–ò–∑—Ä–∞–∑—ä—Ç `(x + y + z)` —Å–µ –∏–∑—á–∏—Å–ª—è–≤–∞ **n –ø—ä—Ç–∏!**

</div>
<div class="column right">

**‚úÖ –°–ª–µ–¥ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:**
```cpp
int temp = x + y + z;
for (int i = 0; i < n; ++i) {
    arr[i] = arr[i] * temp;
}
```

–ò–∑—Ä–∞–∑—ä—Ç —Å–µ –∏–∑—á–∏—Å–ª—è–≤–∞ **–≤–µ–¥–Ω—ä–∂!**

</div>
</div>

Note:
–ö–æ–º–ø–∏–ª–∞—Ç–æ—Ä—ä—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∏–∑–≤—ä—Ä—à–≤–∞ —Ç–∞–∑–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –Ω–∞ –ø–æ–≤–µ—á–µ—Ç–æ –Ω–∏–≤–∞ –Ω–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è.

---

## Vectorization (SIMD)

**Single Instruction, Multiple Data**

–û–±—Ä–∞–±–æ—Ç–≤–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –¥–∞–Ω–Ω–∏ –Ω–∞–≤–µ–¥–Ω—ä–∂ —Å –µ–¥–Ω–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

<div class="columns">
<div class="column left">

```cpp
// –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞
for (int i = 0; i < n; ++i) {
    c[i] = a[i] + b[i];
}
```

**–ë–µ–∑ SIMD:** 1 –æ–ø–µ—Ä–∞—Ü–∏—è/–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

</div>
<div class="column right">

```cpp
// –í–µ–∫—Ç–æ—Ä–∏–∑–∏—Ä–∞–Ω –∫–æ–¥ (–ø—Å–µ–≤–¥–æ)
for (int i = 0; i < n; i += 4) {
    // vpaddd –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è (x86-64)
    // –û–±—Ä–∞–±–æ—Ç–≤–∞ 4 int –Ω–∞–≤–µ–¥–Ω—ä–∂
    vec_c = vec_add(vec_a, vec_b);
}
```

**–° SIMD:** 4 –æ–ø–µ—Ä–∞—Ü–∏–∏/–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è = **4x —É—Å–∫–æ—Ä–µ–Ω–∏–µ!**

</div>
</div>

Note:
–ú–æ–¥–µ—Ä–Ω–∏—Ç–µ CPU –∏–º–∞—Ç SIMD —Ä–µ–≥–∏—Å—Ç—Ä–∏ (SSE, AVX, AVX-512) –∫–æ–∏—Ç–æ –ø–æ–∑–≤–æ–ª—è–≤–∞—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ 4-16 –µ–ª–µ–º–µ–Ω—Ç–∞ –µ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.

---

## Function Inlining

–ó–∞–º–µ—Å—Ç–≤–∞ –∏–∑–≤–∏–∫–≤–∞–Ω–µ—Ç–æ –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è —Å —Ç—è–ª–æ—Ç–æ –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è—Ç–∞ –¥–∏—Ä–µ–∫—Ç–Ω–æ

<div class="columns">
<div class="column left">

**–ü—Ä–µ–¥–∏ inlining:**
```cpp
inline int square(int x) {
    return x * x;
}

int result = square(5);
```

Overhead: call, push, pop, return

</div>
<div class="column right">

**–°–ª–µ–¥ inlining:**
```cpp
int result = 5 * 5;
// –ú–æ–∂–µ –¥–æ—Ä–∏ –¥–∞ —Å—Ç–∞–Ω–µ:
int result = 25;
```

**–ë–µ–∑ overhead!**

</div>
</div>

**–ü—Ä–µ–¥–∏–º—Å—Ç–≤–∞:**
- ‚úÖ –ï–ª–∏–º–∏–Ω–∏—Ä–∞ function call overhead
- ‚úÖ –ü–æ–∑–≤–æ–ª—è–≤–∞ –¥–æ–ø—ä–ª–Ω–∏—Ç–µ–ª–Ω–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- ‚úÖ –ü–æ–¥–æ–±—Ä—è–≤–∞ instruction cache locality

**–ù–µ–¥–æ—Å—Ç–∞—Ç—ä—Ü–∏:**
- ‚ùå –£–≤–µ–ª–∏—á–∞–≤–∞ —Ä–∞–∑–º–µ—Ä–∞ –Ω–∞ –∫–æ–¥–∞

Note:
–ö–æ–º–ø–∏–ª–∞—Ç–æ—Ä—ä—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Ä–µ—à–∞–≤–∞ –∫–æ–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–∞ inline-–Ω–µ, –Ω–æ `inline` keyword –µ hint.

---

## –ù–∏–≤–∞ –Ω–∞ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

| –ù–∏–≤–æ | –û–ø–∏—Å–∞–Ω–∏–µ | –£–ø–æ—Ç—Ä–µ–±–∞ |
|------|----------|----------|
| **-O0** | –ë–µ–∑ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ | üîß Debugging |
| **-O1** | –û—Å–Ω–æ–≤–Ω–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ | –ë–∞–ª–∞–Ω—Å |
| **-O2** | –ü–æ–≤–µ—á–µ—Ç–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ | ‚≠ê **Production** |
| **-O3** | –ê–≥—Ä–µ—Å–∏–≤–Ω–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ | üöÄ Performance |

**–ü—Ä–µ–ø–æ—Ä—ä–∫–∞:**
- **-O0** ‚Üí debugging (assembly —Å—ä–æ—Ç–≤–µ—Ç—Å—Ç–≤–∞ –Ω–∞ source)
- **-O2** ‚Üí production –ø–æ –ø–æ–¥—Ä–∞–∑–±–∏—Ä–∞–Ω–µ
- **-O3** ‚Üí –ø–æ—Å–ª–µ –ø—Ä–æ—Ñ–∏–ª–∏—Ä–∞–Ω–µ (—Ç–µ—Å—Ç–≤–∞–π—Ç–µ –≤–Ω–∏–º–∞—Ç–µ–ª–Ω–æ!)

Note:
-O3 –≤–∫–ª—é—á–≤–∞ unrolling, vectorization, aggressive inlining - –º–æ–∂–µ –¥–∞ —É–≤–µ–ª–∏—á–∏ —Ä–∞–∑–º–µ—Ä–∞ –Ω–∞ –∫–æ–¥–∞ –∑–Ω–∞—á–∏—Ç–µ–ª–Ω–æ.

---

<!-- .slide: data-background="#fff3e0" -->

# –ß–∞—Å—Ç 3

## –õ–æ–∫–∞–ª–Ω–æ—Å—Ç –Ω–∞ –î–∞–Ω–Ω–∏—Ç–µ

---

## –ö–∞–∫–≤–æ –µ –õ–æ–∫–∞–ª–Ω–æ—Å—Ç?

**–õ–æ–∫–∞–ª–Ω–æ—Å—Ç—Ç–∞ –Ω–∞ –¥–∞–Ω–Ω–∏—Ç–µ** = —Ç–µ–Ω–¥–µ–Ω—Ü–∏—è—Ç–∞ –Ω–∞ –ø—Ä–æ–≥—Ä–∞–º–∞ –¥–∞ –¥–æ—Å—Ç—ä–ø–≤–∞ –¥–∞–Ω–Ω–∏, –∫–æ–∏—Ç–æ —Å–∞ –±–ª–∏–∑–æ –≤ –ø–∞–º–µ—Ç—Ç–∞ –∏–ª–∏ —Å–µ –ø—Ä–µ–∏–∑–ø–æ–ª–∑–≤–∞—Ç –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ

### –î–≤–∞ –≤–∏–¥–∞ –ª–æ–∫–∞–ª–Ω–æ—Å—Ç:

1. **–ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–∞ –õ–æ–∫–∞–ª–Ω–æ—Å—Ç** - –¥–æ—Å—Ç—ä–ø –¥–æ –±–ª–∏–∑–∫–∏ –¥–∞–Ω–Ω–∏
2. **–í—Ä–µ–º–µ–Ω–Ω–∞ –õ–æ–∫–∞–ª–Ω–æ—Å—Ç** - –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–µ–Ω –¥–æ—Å—Ç—ä–ø –¥–æ —Å—ä—â–∏—Ç–µ –¥–∞–Ω–Ω–∏

**–ó–∞—â–æ –µ –∫—Ä–∏—Ç–∏—á–Ω–æ?**

CPU –∫–µ—à–æ–≤–µ—Ç–µ –ø—Ä–∞–≤—è—Ç –¥–∞–Ω–Ω–∏—Ç–µ —Å –¥–æ–±—Ä–∞ –ª–æ–∫–∞–ª–Ω–æ—Å—Ç **100-300x –ø–æ-–±—ä—Ä–∑–∏** –∑–∞ –¥–æ—Å—Ç—ä–ø!

Note:
–õ–æ–∫–∞–ª–Ω–æ—Å—Ç—Ç–∞ –µ –µ–¥–∏–Ω –æ—Ç –Ω–∞–π-–≤–∞–∂–Ω–∏—Ç–µ —Ñ–∞–∫—Ç–æ—Ä–∏ –∑–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–Ω–æ—Å—Ç—Ç–∞ –Ω–∞ –º–æ–¥–µ—Ä–µ–Ω —Ö–∞—Ä–¥—É–µ—Ä.

---

## –ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–∞ –õ–æ–∫–∞–ª–Ω–æ—Å—Ç

**–î–µ—Ñ–∏–Ω–∏—Ü–∏—è**: –ü—Ä–æ–≥—Ä–∞–º–∞—Ç–∞ –¥–æ—Å—Ç—ä–ø–≤–∞ –¥–∞–Ω–Ω–∏, –∫–æ–∏—Ç–æ —Å–∞ —Ñ–∏–∑–∏—á–µ—Å–∫–∏ –±–ª–∏–∑–æ –µ–¥–Ω–∞ –¥–æ –¥—Ä—É–≥–∞ –≤ –ø–∞–º–µ—Ç—Ç–∞

<div class="columns">
<div class="column left">

### ‚úÖ –î–æ–±—Ä–∞ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–∞ –ª–æ–∫–∞–ª–Ω–æ—Å—Ç

```cpp
for (int i = 0; i < n; ++i) {
    sum += arr[i];
}
```

–î–æ—Å—Ç—ä–ø–≤–∞ `arr[0]`, `arr[1]`, `arr[2]`...

**Cache line –∑–∞—Ä–µ–∂–¥–∞ —Å—ä—Å–µ–¥–Ω–∏ –µ–ª–µ–º–µ–Ω—Ç–∏!**

</div>
<div class="column right">

### ‚ùå –õ–æ—à–∞ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–∞ –ª–æ–∫–∞–ª–Ω–æ—Å—Ç

```cpp
for (int i = 0; i < n; i += 100) {
    sum += arr[i];
}
```

–î–æ—Å—Ç—ä–ø–≤–∞ `arr[0]`, `arr[100]`, `arr[200]`...

**–í—Å–µ–∫–∏ –¥–æ—Å—Ç—ä–ø –µ cache miss!**

**–ú–æ–∂–µ –¥–∞ –µ 10-100x –ø–æ-–±–∞–≤–Ω–æ!**

</div>
</div>

Note:
Cache line –æ–±–∏–∫–Ω–æ–≤–µ–Ω–æ –µ 64 bytes. –ê–∫–æ –¥–æ—Å—Ç—ä–ø–≤–∞—à arr[0], cache line –∑–∞—Ä–µ–∂–¥–∞ arr[0]-arr[15] (–∑–∞ 4-byte int).

---

## –í—Ä–µ–º–µ–Ω–Ω–∞ –õ–æ–∫–∞–ª–Ω–æ—Å—Ç

**–î–µ—Ñ–∏–Ω–∏—Ü–∏—è**: –ü—Ä–æ–≥—Ä–∞–º–∞—Ç–∞ –¥–æ—Å—Ç—ä–ø–≤–∞ —Å—ä—â–∏—Ç–µ –¥–∞–Ω–Ω–∏ –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ –≤ –∫—Ä–∞—Ç—ä–∫ –ø–µ—Ä–∏–æ–¥ –æ—Ç –≤—Ä–µ–º–µ

```cpp
int sum = 0;
for (int i = 0; i < n; ++i) {
    sum += arr[i];  // sum —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞ –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ
}
```

**`sum` –ø–æ–∫–∞–∑–≤–∞ –æ—Ç–ª–∏—á–Ω–∞ –≤—Ä–µ–º–µ–Ω–Ω–∞ –ª–æ–∫–∞–ª–Ω–æ—Å—Ç:**
- –ü—ä—Ä–≤–∏—è—Ç –¥–æ—Å—Ç—ä–ø –∑–∞—Ä–µ–∂–¥–∞ `sum` –≤ –∫–µ—à–∞
- –í—Å–∏—á–∫–∏ –ø–æ—Å–ª–µ–¥–≤–∞—â–∏ –¥–æ—Å—Ç—ä–ø–∏ —Å–∞ **cache hits**
- `sum` –≤–µ—Ä–æ—è—Ç–Ω–æ –æ—Å—Ç–∞–≤–∞ –≤ L1 –∫–µ—à–∞ (–Ω–∞–π-–±—ä—Ä–∑–∏—è—Ç)

Note:
–í—Ä–µ–º–µ–Ω–Ω–∞—Ç–∞ –ª–æ–∫–∞–ª–Ω–æ—Å—Ç –µ –ø—Ä–∏—á–∏–Ω–∞—Ç–∞ –ª–æ–∫–∞–ª–Ω–∏—Ç–µ –ø—Ä–æ–º–µ–Ω–ª–∏–≤–∏ –¥–∞ —Å–∞ —Ç–æ–ª–∫–æ–≤–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–∏.

---

## CPU Cache –ô–µ—Ä–∞—Ä—Ö–∏—è

<div class="columns">
<div class="column left">

**Cache –ù–∏–≤–∞:**
- **L1 Cache**: 32-64 KB, 1-4 —Ü–∏–∫—ä–ª–∞
- **L2 Cache**: 256 KB - 1 MB, 10-20 —Ü–∏–∫—ä–ª–∞
- **L3 Cache**: 4-32 MB, 40-75 —Ü–∏–∫—ä–ª–∞
- **RAM**: GB, **100-300 —Ü–∏–∫—ä–ª–∞** üêå

</div>
<div class="column right">

**Performance Impact:**

| –°—ä–±–∏—Ç–∏–µ | –í—Ä–µ–º–µ |
|---------|-------|
| L1 hit | ‚ö° 1-4 cycles |
| L2 hit | 10-20 cycles |
| L3 hit | 40-75 cycles |
| **RAM (miss)** | **üêå 100-300 cycles** |

**Cache miss –µ 100-300x –ø–æ-–±–∞–≤–µ–Ω!**

</div>
</div>

Note:
–¢–æ–≤–∞ –µ –ø—Ä–∏—á–∏–Ω–∞—Ç–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏—Ç–µ –∑–∞ –ª–æ–∫–∞–ª–Ω–æ—Å—Ç –¥–∞ –∏–º–∞—Ç —Ç–æ–ª–∫–æ–≤–∞ –≥–æ–ª—è–º –µ—Ñ–µ–∫—Ç - —Ä–∞–∑–ª–∏–∫–∞—Ç–∞ –µ –æ–≥—Ä–æ–º–Ω–∞!

---

## Cache-Friendly vs Cache-Unfriendly

<div class="columns">
<div class="column left">

### ‚úÖ Cache-Friendly

```cpp
// –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–µ–Ω –¥–æ—Å—Ç—ä–ø
std::vector<int> vec(1000);
long long sum = 0;

for (int i = 0; i < vec.size(); ++i) {
    sum += vec[i];
}
```

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**
- –ù–µ–ø—Ä–µ–∫—ä—Å–Ω–∞—Ç–∞ –ø–∞–º–µ—Ç
- –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–µ–Ω –¥–æ—Å—Ç—ä–ø
- –û—Ç–ª–∏—á–Ω–∞ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–∞ –ª–æ–∫–∞–ª–Ω–æ—Å—Ç
- –í–∏—Å–æ–∫–∏ cache hit rates

</div>
<div class="column right">

### ‚ùå Cache-Unfriendly

```cpp
// Strided –¥–æ—Å—Ç—ä–ø
std::vector<int> vec(10000);
long long sum = 0;

for (int i = 0; i < vec.size(); i += 100) {
    sum += vec[i];
}
```

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**
- –ì–æ–ª–µ–º–∏ —Å–∫–æ–∫–æ–≤–µ –≤ –ø–∞–º–µ—Ç—Ç–∞
- –õ–æ—à–∞ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–∞ –ª–æ–∫–∞–ª–Ω–æ—Å—Ç
- –ù–∏—Å–∫–∏ cache hit rates
- **–ú–æ–∂–µ –¥–∞ –µ 10-100x –ø–æ-–±–∞–≤–Ω–æ!**

</div>
</div>

Note:
–ü—Ä–∏ stride = 100 –∏ 4-byte integers, —Å–∫–∞—á–∞–º–µ —Å 400 bytes - –º–Ω–æ–≥–æ –ø–æ–≤–µ—á–µ –æ—Ç cache line —Ä–∞–∑–º–µ—Ä–∞.

---

<!-- .slide: data-background="#fce4ec" -->

# –ß–∞—Å—Ç 4

## C++ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏ –∏ –ú–∞—Å–∏–≤–∏

---

## –ü–∞–º–µ—Ç–Ω–∞ –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –Ω–∞ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏—Ç–µ

| –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä | –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è | –õ–æ–∫–∞–ª–Ω–æ—Å—Ç | –£–ø–æ—Ç—Ä–µ–±–∞ |
|-----------|-------------|-----------|----------|
| **`std::array`** | –ù–µ–ø—Ä–µ–∫—ä—Å–Ω–∞—Ç, stack | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | –§–∏–∫—Å–∏—Ä–∞–Ω, compile-time |
| **`std::vector`** | –ù–µ–ø—Ä–µ–∫—ä—Å–Ω–∞—Ç, heap | ‚≠ê‚≠ê‚≠ê‚≠ê | **Default –∏–∑–±–æ—Ä** |
| **`std::list`** | –†–∞–∑–ø—Ä—ä—Å–Ω–∞—Ç–∏ –≤—ä–∑–ª–∏ | ‚≠ê | –ß–µ—Å—Ç–∏—Ç–µ insert/delete |
| **`std::map`** | Red-Black –¥—ä—Ä–≤–æ | ‚≠ê | Sorted key-value |

**–ü—Ä–∞–≤–∏–ª–æ:** –ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞–π—Ç–µ –Ω–µ–ø—Ä–µ–∫—ä—Å–Ω–∞—Ç–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏!

Note:
–ó–∞ 95% –æ—Ç —Å–ª—É—á–∞–∏—Ç–µ, std::vector –µ –Ω–∞–π-–¥–æ–±—Ä–∏—è—Ç –∏–∑–±–æ—Ä –±–ª–∞–≥–æ–¥–∞—Ä–µ–Ω–∏–µ –Ω–∞ –æ—Ç–ª–∏—á–Ω–∞—Ç–∞ –ª–æ–∫–∞–ª–Ω–æ—Å—Ç.

---

## std::array vs std::vector

<div class="columns">
<div class="column left">

### `std::array` - Stack-Based

```cpp
#include <array>

std::array<int, 5> arr = {1, 2, 3, 4, 5};
arr[0] = 10;
arr.at(0) = 10;  // Bounds checking
```

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**
- ‚úÖ Compile-time —Ä–∞–∑–º–µ—Ä
- ‚úÖ Stack allocation
- ‚úÖ –ù—É–ª–µ–≤ overhead
- ‚úÖ –û—Ç–ª–∏—á–Ω–∞ –ª–æ–∫–∞–ª–Ω–æ—Å—Ç
- ‚ùå –§–∏–∫—Å–∏—Ä–∞–Ω —Ä–∞–∑–º–µ—Ä

</div>
<div class="column right">

### `std::vector` - Heap-Based

```cpp
#include <vector>

std::vector<int> vec;
vec.push_back(10);
vec.reserve(100);
vec[0] = 5;
```

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**
- ‚úÖ –î–∏–Ω–∞–º–∏—á–µ–Ω —Ä–∞–∑–º–µ—Ä
- ‚úÖ Heap allocation
- ‚úÖ –û—Ç–ª–∏—á–Ω–∞ –ª–æ–∫–∞–ª–Ω–æ—Å—Ç
- ‚úÖ –ú–æ–∂–µ –¥–∞ —Ä–∞—Å—Ç–µ
- ‚ö†Ô∏è –ú–∞–ª—ä–∫ overhead (capacity)

</div>
</div>

Note:
–ò –¥–≤–∞—Ç–∞ —Å–∞ –Ω–µ–ø—Ä–µ–∫—ä—Å–Ω–∞—Ç–∏ –≤ –ø–∞–º–µ—Ç—Ç–∞, –∫–æ–µ—Ç–æ –≥–∏ –ø—Ä–∞–≤–∏ –∏–∑–∫–ª—é—á–∏—Ç–µ–ª–Ω–æ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–∏ –∑–∞ –∏—Ç–µ—Ä–∞—Ü–∏—è.

---

## std::list - Doubly Linked List

```cpp
#include <list>

std::list<int> lst;
lst.push_back(10);
lst.push_front(5);
auto it = lst.begin();
++it;
lst.insert(it, 7);
```

### –ü–∞–º–µ—Ç–Ω–∞ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è:

```
Node 1        Node 2        Node 3
[prev|5|next] [prev|7|next] [prev|10|next]
    ‚Üì              ‚Üì              ‚Üì
Heap —Ä–∞–∑–ø—Ä—ä—Å–Ω–∞—Ç–∏ –∞–ª–æ–∫–∞—Ü–∏–∏
```

**–ü—Ä–æ–±–ª–µ–º:** –í—Å–µ–∫–∏ –≤—ä–∑–µ–ª –µ –æ—Ç–¥–µ–ª–Ω–∞ –∞–ª–æ–∫–∞—Ü–∏—è ‚Üí **–ª–æ—à–∞ –∫–µ—à –ª–æ–∫–∞–ª–Ω–æ—Å—Ç!**

Note:
std::list –µ –±–∞–≤–µ–Ω –∑–∞ –∏—Ç–µ—Ä–∞—Ü–∏—è, –Ω–æ O(1) insert/delete —Å–ª–µ–¥ –Ω–∞–º–∏—Ä–∞–Ω–µ –Ω–∞ –ø–æ–∑–∏—Ü–∏—è—Ç–∞. –ò–∑–ø–æ–ª–∑–≤–∞–π—Ç–µ —Å–∞–º–æ –∫–æ–≥–∞—Ç–æ –µ –Ω–∞–∏—Å—Ç–∏–Ω–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ.

---

## Performance: vector vs list

### –ï–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç: –°—É–º–∏—Ä–∞–Ω–µ –Ω–∞ 1,000,000 –µ–ª–µ–º–µ–Ω—Ç–∞

```cpp
// std::vector
long long sum = 0;
for (int val : vec) sum += val;
// –í—Ä–µ–º–µ: ~1ms

// std::list
long long sum = 0;
for (int val : lst) sum += val;
// –í—Ä–µ–º–µ: ~10-100ms
```

**`std::vector` –µ 10-100x –ø–æ-–±—ä—Ä–∑ –∑–∞ –∏—Ç–µ—Ä–∞—Ü–∏—è!**

**–ó–∞—â–æ?**
- Vector: –Ω–µ–ø—Ä–µ–∫—ä—Å–Ω–∞—Ç, –æ—Ç–ª–∏—á–Ω–∏ cache hits
- List: —Ä–∞–∑–ø—Ä—ä—Å–Ω–∞—Ç, —á–µ—Å—Ç–∏ cache misses

Note:
–¢–æ–≤–∞ –µ —Ä–µ–∞–ª–µ–Ω benchmark. –†–∞–∑–ª–∏–∫–∞—Ç–∞ –º–æ–∂–µ –¥–∞ –µ –¥–æ—Ä–∏ –ø–æ-–≥–æ–ª—è–º–∞ –Ω–∞ –≥–æ–ª–µ–º–∏ datasets.

---

## Call-by-Value vs Call-by-Reference

<div class="columns">
<div class="column left">

### ‚ùå Call-by-Value (–ù–µ–µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ)

```cpp
void process(std::vector<int> vec) {
    // –ö–æ–ø–∏—Ä–∞ —Ü–µ–ª–∏—è –≤–µ–∫—Ç–æ—Ä!
    // –ê–ª–æ–∫–∞—Ü–∏—è + –∫–æ–ø–∏—Ä–∞–Ω–µ –Ω–∞ –≤—Å–∏—á–∫–∏ –µ–ª–µ–º–µ–Ω—Ç–∏
    for (int val : vec) {
        // ...
    }
}
```

**Overhead:**
- Heap –∞–ª–æ–∫–∞—Ü–∏—è
- –ö–æ–ø–∏—Ä–∞–Ω–µ –Ω–∞ –≤—Å–∏—á–∫–∏ –µ–ª–µ–º–µ–Ω—Ç–∏
- –î–µ–∞–ª–æ–∫–∞—Ü–∏—è –ø—Ä–∏ –∏–∑–ª–∏–∑–∞–Ω–µ

</div>
<div class="column right">

### ‚úÖ Call-by-Reference (–ï—Ñ–µ–∫—Ç–∏–≤–Ω–æ)

```cpp
// Const reference - –±–µ–∑ –∫–æ–ø–∏—Ä–∞–Ω–µ
void process(const std::vector<int>& vec) {
    for (int val : vec) {
        // ...
    }
}

// Reference - –ø–æ–∑–≤–æ–ª—è–≤–∞ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è
void modify(std::vector<int>& vec) {
    vec.push_back(42);
}
```

**–ü—Ä–µ–¥–∏–º—Å—Ç–≤–∞:**
- –ù—É–ª–µ–≤ overhead
- –ù—è–º–∞ –∫–æ–ø–∏—Ä–∞–Ω–µ

</div>
</div>

Note:
–ó–∞ performance-critical –∫–æ–¥, –≤–∏–Ω–∞–≥–∏ –∏–∑–ø–æ–ª–∑–≤–∞–π—Ç–µ const reference –∑–∞ –≥–æ–ª–µ–º–∏ –æ–±–µ–∫—Ç–∏.

---

<!-- .slide: data-background="#e0f2f1" -->

# –ß–∞—Å—Ç 5

## –ü—Ä–∞–∫—Ç–∏–∫–∞ —Å Compiler Explorer

---

## Compiler Explorer (godbolt.org)

**–ù–µ–∑–∞–º–µ–Ω–∏–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç** –∑–∞ –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ –Ω–∞ –∫–æ–º–ø–∏–ª–∞—Ç–æ—Ä–Ω–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏!

### –°—Ç—ä–ø–∫–∏:

1. –û—Ç–∏–¥–µ—Ç–µ –Ω–∞ [godbolt.org](https://godbolt.org)
2. –ò–∑–±–µ—Ä–µ—Ç–µ **C++** –∏ –∫–æ–º–ø–∏–ª–∞—Ç–æ—Ä (–Ω–∞–ø—Ä. **GCC 13.2**)
3. –ù–∞–ø–∏—à–µ—Ç–µ –∫–æ–¥
4. –°—Ä–∞–≤–Ω–µ—Ç–µ assembly –ø—Ä–∏ **-O0**, **-O2**, **-O3**

### –ö–∞–∫–≤–æ –º–æ–∂–µ–º –¥–∞ –≤–∏–¥–∏–º:

- Loop unrolling
- Vectorization (SIMD –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏)
- Function inlining
- Dead code elimination
- Constant folding

Note:
Compiler Explorer –µ –Ω–∞–π-–¥–æ–±—Ä–∏—è—Ç –Ω–∞—á–∏–Ω –¥–∞ —Ä–∞–∑–±–µ—Ä–µ—Ç–µ –∫–∞–∫–≤–æ –ø—Ä–∞–≤–∏ –∫–æ–º–ø–∏–ª–∞—Ç–æ—Ä—ä—Ç —Å –≤–∞—à–∏—è –∫–æ–¥.

---

## –ü—Ä–∏–º–µ—Ä: –°—É–º–∏—Ä–∞–Ω–µ –Ω–∞ –ú–∞—Å–∏–≤

```cpp
int sum_array(int* arr, int size) {
    int total = 0;
    for (int i = 0; i < size; ++i) {
        total += arr[i];
    }
    return total;
}
```

### –ù–∞–±–ª—é–¥–µ–Ω–∏—è –ø—Ä–∏ —Ä–∞–∑–ª–∏—á–Ω–∏ –Ω–∏–≤–∞:

**-O0**: –Ø—Å–Ω–∞ loop —Å—Ç—Ä—É–∫—Ç—É—Ä–∞, –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏, –ø—Ä–æ—Å—Ç –∫–æ–¥
**-O2**: –ü–æ-–µ—Ñ–µ–∫—Ç–∏–≤–µ–Ω loop, –ø–æ-–º–∞–ª–∫–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏, –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
**-O3**: –í–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è! SIMD –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ (`vpaddd`), –ø–∞—Ä–∞–ª–µ–ª–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞

**–ï–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–∞–π—Ç–µ –Ω–∞ godbolt.org!**

Note:
–¢–æ–∑–∏ –∫–æ–¥ –µ –∏–¥–µ–∞–ª–µ–Ω –∑–∞ –≤–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è - –ø—Ä–æ—Å—Ç–∞ –∏—Ç–µ—Ä–∞—Ü–∏—è —Å –Ω–µ–∑–∞–≤–∏—Å–∏–º–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏.

---

## –°–∏–ª–∞—Ç–∞ –Ω–∞ `__restrict`

**Pointer Aliasing** –º–æ–∂–µ –¥–∞ –ø–æ–ø—Ä–µ—á–∏ –Ω–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏—Ç–µ

<div class="columns">
<div class="column left">

### –ë–µ–∑ `__restrict`

```cpp
void add_arrays(int* a, int* b, int* c, int n) {
    for (int i = 0; i < n; i++) {
        a[i] = b[i] + c[i];
    }
}
```

–ö–æ–º–ø–∏–ª–∞—Ç–æ—Ä—ä—Ç **–Ω–µ –∑–Ω–∞–µ** –¥–∞–ª–∏ `a`, `b`, `c` —Å–µ –ø—Ä–∏–ø–æ–∫—Ä–∏–≤–∞—Ç.

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏!**

</div>
<div class="column right">

### –° `__restrict`

```cpp
void add_arrays(int* __restrict a,
                int* __restrict b,
                int* __restrict c, int n) {
    for (int i = 0; i < n; i++) {
        a[i] = b[i] + c[i];
    }
}
```

–û–±–µ—â–∞–Ω–∏–µ –∫—ä–º –∫–æ–º–ø–∏–ª–∞—Ç–æ—Ä–∞: **—É–∫–∞–∑–∞—Ç–µ–ª–∏—Ç–µ –ù–ï —Å–µ –ø—Ä–∏–ø–æ–∫—Ä–∏–≤–∞—Ç!**

**–ê–≥—Ä–µ—Å–∏–≤–Ω–∞ –≤–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è!**

</div>
</div>

**Performance Impact: 2-4x —É—Å–∫–æ—Ä–µ–Ω–∏–µ!**

Note:
`__restrict` –µ –º–æ—â–µ–Ω, –Ω–æ –æ–ø–∞—Å–µ–Ω - –∞–∫–æ –Ω–∞—Ä—É—à–∏—Ç–µ –æ–±–µ—â–∞–Ω–∏–µ—Ç–æ, –ø–æ–≤–µ–¥–µ–Ω–∏–µ—Ç–æ –µ undefined!

---

## –ï–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç: vector vs array

```cpp
// Raw –º–∞—Å–∏–≤
void process_array(int* arr, int n) {
    for (int i = 0; i < n; i++) {
        arr[i] = arr[i] * 2;
    }
}

// std::vector
void process_vector(std::vector<int>& vec) {
    for (int i = 0; i < vec.size(); i++) {
        vec[i] = vec[i] * 2;
    }
}
```

### –° -O3: –ò –¥–≤–µ—Ç–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å–∞ –≤–µ–∫—Ç–æ—Ä–∏–∑–∏—Ä–∞–Ω–∏!

**–ò–∑–Ω–µ–Ω–∞–¥–∞:** `std::vector` –µ **—Ç–æ–ª–∫–æ–≤–∞ –±—ä—Ä–∑** –∫–æ–ª–∫–æ—Ç–æ raw –º–∞—Å–∏–≤!

Note:
–ö–æ–º–ø–∏–ª–∞—Ç–æ—Ä—ä—Ç –≤–∏–∂–¥–∞ —á–µ vec[i] –µ –ø—Ä–æ—Å—Ç–æ dereference –Ω–∞ —É–∫–∞–∑–∞—Ç–µ–ª –∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–∞ –∏–¥–µ–Ω—Ç–∏—á–Ω–æ.

---

<!-- .slide: data-background="#f3e5f5" -->

# –û–±–æ–±—â–µ–Ω–∏–µ

---

## –ö–ª—é—á–æ–≤–∏ –ò–∑–≤–æ–¥–∏: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

‚úÖ **–ö–æ–º–ø–∏–ª–∞—Ç–æ—Ä–Ω–∏ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏**
- Constant folding, CSE, dead code removal
- Loop unrolling, vectorization, inlining
- –ù–∏–≤–∞: -O0 (debug), -O2 (production), -O3 (performance)

‚úÖ **–†–∞–∑–±–∏—Ä–∞–Ω–µ –Ω–∞ Assembly**
- Compiler Explorer –µ –Ω–µ–∑–∞–º–µ–Ω–∏–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç
- –ù–∞–±–ª—é–¥–∞–≤–∞–π—Ç–µ –∫–∞–∫ –∫–æ–¥—ä—Ç —Å–µ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä–∞
- –ï–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–∞–π—Ç–µ —Å —Ä–∞–∑–ª–∏—á–Ω–∏ –ø–æ–¥—Ö–æ–¥–∏

‚úÖ **–ü–æ–º–æ–≥–Ω–µ—Ç–µ –Ω–∞ –ö–æ–º–ø–∏–ª–∞—Ç–æ—Ä–∞**
- `const` –ø–æ–∑–≤–æ–ª—è–≤–∞ –ø–æ–≤–µ—á–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- `__restrict` –ø—Ä–µ–º–∞—Ö–≤–∞ pointer aliasing
- –ü–∏—à–µ—Ç–µ –∫–æ–¥ –∫–æ–π—Ç–æ –µ –ª–µ—Å–µ–Ω –∑–∞ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–∞–Ω–µ

Note:
–ö–æ–º–ø–∏–ª–∞—Ç–æ—Ä–∏—Ç–µ —Å–∞ –º–æ—â–Ω–∏, –Ω–æ –Ω–µ —Å–∞ –º–∞–≥–∏—è. –ü—Ä–æ–≥—Ä–∞–º–∏—Å—Ç—ä—Ç —Ç—Ä—è–±–≤–∞ –¥–∞ –∏–º –ø–æ–º–∞–≥–∞!

---

## –ö–ª—é—á–æ–≤–∏ –ò–∑–≤–æ–¥–∏: –õ–æ–∫–∞–ª–Ω–æ—Å—Ç

‚úÖ **–ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–∞ –õ–æ–∫–∞–ª–Ω–æ—Å—Ç**
- –î–æ—Å—Ç—ä–ø –¥–æ –±–ª–∏–∑–∫–∏ –¥–∞–Ω–Ω–∏ –≤ –ø–∞–º–µ—Ç—Ç–∞
- –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–µ–Ω –¥–æ—Å—Ç—ä–ø –µ –Ω–∞–π-–¥–æ–±—ä—Ä
- –ò–∑–±—è–≥–≤–∞–π—Ç–µ –≥–æ–ª–µ–º–∏ —Å–∫–æ–∫–æ–≤–µ (strided access)

‚úÖ **–í—Ä–µ–º–µ–Ω–Ω–∞ –õ–æ–∫–∞–ª–Ω–æ—Å—Ç**
- –ú–Ω–æ–≥–æ–∫—Ä–∞—Ç–µ–Ω –¥–æ—Å—Ç—ä–ø –¥–æ —Å—ä—â–∏—Ç–µ –¥–∞–Ω–Ω–∏
- –õ–æ–∫–∞–ª–Ω–∏—Ç–µ –ø—Ä–æ–º–µ–Ω–ª–∏–≤–∏ —Å–∞ –æ—Ç–ª–∏—á–Ω–∏
- –ü—Ä–µ–∏–∑–ø–æ–ª–∑–≤–∞–π—Ç–µ –¥–∞–Ω–Ω–∏—Ç–µ –∫–æ–ª–∫–æ—Ç–æ —Å–µ –º–æ–∂–µ

‚úÖ **Cache Performance**
- Cache hit: 1-10 cycles ‚ö°
- Cache miss: 100-300 cycles üêå
- **100-300x —Ä–∞–∑–ª–∏–∫–∞!**

Note:
–õ–æ–∫–∞–ª–Ω–æ—Å—Ç—Ç–∞ –µ –µ–¥–∏–Ω –æ—Ç –Ω–∞–π-–≤–∞–∂–Ω–∏—Ç–µ —Ñ–∞–∫—Ç–æ—Ä–∏ –∑–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–Ω–æ—Å—Ç—Ç–∞ –Ω–∞ –º–æ–¥–µ—Ä–µ–Ω —Ö–∞—Ä–¥—É–µ—Ä.

---

## –ö–ª—é—á–æ–≤–∏ –ò–∑–≤–æ–¥–∏: –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏

‚úÖ **–ò–∑–±–æ—Ä –Ω–∞ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä**
- **`std::vector`** - default –∏–∑–±–æ—Ä –∑–∞ –º–∞—Å–∏–≤–∏
- **`std::array`** - –∑–∞ compile-time —Ñ–∏–∫—Å–∏—Ä–∞–Ω —Ä–∞–∑–º–µ—Ä
- **`std::list`** - —Å–∞–º–æ –∞–∫–æ —á–µ—Å—Ç–∏—Ç–µ insert/delete —Å–∞ –∫—Ä–∏—Ç–∏—á–Ω–∏
- **`std::map`** - sorted key-value, O(log n)

‚úÖ **–ü–∞–º–µ—Ç–Ω–∞ –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è**
- –ù–µ–ø—Ä–µ–∫—ä—Å–Ω–∞—Ç–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏ ‚Üí –æ—Ç–ª–∏—á–Ω–∞ –ª–æ–∫–∞–ª–Ω–æ—Å—Ç
- –ë–∞–∑–∏—Ä–∞–Ω–∏ –Ω–∞ —É–∫–∞–∑–∞—Ç–µ–ª–∏ ‚Üí –ª–æ—à–∞ –ª–æ–∫–∞–ª–Ω–æ—Å—Ç
- **Vector –º–æ–∂–µ –¥–∞ –µ 10-100x –ø–æ-–±—ä—Ä–∑ –æ—Ç list!**

‚úÖ **Call-by-Reference**
- –ò–∑–ø–æ–ª–∑–≤–∞–π—Ç–µ `const&` –∑–∞ –≥–æ–ª–µ–º–∏ –æ–±–µ–∫—Ç–∏
- –ò–∑–±—è–≥–≤–∞–π—Ç–µ call-by-value –∑–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏

Note:
–ó–∞ 95% –æ—Ç —Å–ª—É—á–∞–∏—Ç–µ, std::vector –µ –ø—Ä–∞–≤–∏–ª–Ω–∏—è—Ç –∏–∑–±–æ—Ä!

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

> –†–∞–∑–±–∏—Ä–∞–Ω–µ—Ç–æ –Ω–∞ **–∫–æ–º–ø–∏–ª–∞—Ç–æ—Ä–Ω–∏—Ç–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏** –∏ **–ª–æ–∫–∞–ª–Ω–æ—Å—Ç—Ç–∞ –Ω–∞ –¥–∞–Ω–Ω–∏—Ç–µ** –≤–∏ –ø—Ä–∞–≤–∏ –ø–æ-–¥–æ–±—ä—Ä C++ –ø—Ä–æ–≥—Ä–∞–º–∏—Å—Ç. –ù–µ —Å—Ç–∞–≤–∞ –≤—ä–ø—Ä–æ—Å –∑–∞ –º–∏–∫—Ä–æ-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏, –∞ –∑–∞ **—Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª–Ω–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∏ —Ä–µ—à–µ–Ω–∏—è** –∫–æ–∏—Ç–æ –∏–º–∞—Ç –æ–≥—Ä–æ–º–Ω–æ –≤—ä–∑–¥–µ–π—Å—Ç–≤–∏–µ –≤—ä—Ä—Ö—É –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–Ω–æ—Å—Ç—Ç–∞.

**–ï–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–∞–π—Ç–µ —Å Compiler Explorer –∏ –Ω–∞–±–ª—é–¥–∞–≤–∞–π—Ç–µ –∫–∞–∫ –∫–æ–¥—ä—Ç —Å–µ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä–∞!**

---

## –î–æ–ø—ä–ª–Ω–∏—Ç–µ–ª–Ω–∏ –†–µ—Å—É—Ä—Å–∏

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏:**
- [Compiler Explorer (godbolt.org)](https://godbolt.org) - Assembly –∞–Ω–∞–ª–∏–∑
- [Quick Bench](https://quick-bench.com) - Micro-benchmarking
- Valgrind, perf - Profiling tools

**–ß–µ—Ç–∏–≤–∞:**
- "Computer Systems: A Programmer's Perspective" (Bryant & O'Hallaron)
- "The Art of Writing Efficient Programs" (Fedor G. Pikus)
- "Optimizing C++" (Agner Fog)

**–û–Ω–ª–∞–π–Ω:**
- [GCC Optimize Options](https://gcc.gnu.org/onlinedocs/gcc/Optimize-Options.html)
- [What Every Programmer Should Know About Memory](https://people.freebsd.org/~lstewart/articles/cpumemory.pdf)

Note:
–¢–µ–∑–∏ —Ä–µ—Å—É—Ä—Å–∏ —Å–∞ –æ—Ç–ª–∏—á–Ω–∏ –∑–∞ –∑–∞–¥—ä–ª–±–æ—á–µ–Ω–æ –∏–∑—É—á–∞–≤–∞–Ω–µ –Ω–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏—Ç–µ.

---

<!-- .slide: data-background="#4caf50" -->

# –ë–ª–∞–≥–æ–¥–∞—Ä—è –∑–∞ –í–Ω–∏–º–∞–Ω–∏–µ—Ç–æ!

## –í—ä–ø—Ä–æ—Å–∏? üéì

**–°–ª–µ–¥–≤–∞—â–∞ –ª–µ–∫—Ü–∏—è:** –ú–∞—Å–∏–≤–∏ –∏ –î–≤–æ–∏—á–Ω–æ –¢—ä—Ä—Å–µ–Ω–µ

**–ï–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–∞–π—Ç–µ —Å [godbolt.org](https://godbolt.org)!**

Note:
–í—Ä–µ–º–µ –∑–∞ –≤—ä–ø—Ä–æ—Å–∏! –ù–µ —Å–µ –ø—Ä–∏—Ç–µ—Å–Ω—è–≤–∞–π—Ç–µ –¥–∞ –ø–∏—Ç–∞—Ç–µ –∑–∞ –∫–æ–º–ø–∏–ª–∞—Ç–æ—Ä–Ω–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏, –ª–æ–∫–∞–ª–Ω–æ—Å—Ç, –∏–ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏.
